# 🌏 여행 추천 플랫폼 - 좌표 문제 해결 버전

## ✨ 주요 개선사항

### 🎯 좌표 튀는 문제 완전 해결

이전 버전에서 카카오맵 마커가 바다나 엉뚱한 곳에 찍히는 문제를 다음과 같이 해결했습니다:

#### 1. **Gemini 프롬프트 강화**
- 실제 좌표 사용 명시 (소수점 4자리 이상 필수)
- 예시 좌표(37.5, 127.0) 사용 금지 강조
- 지역별 좌표 범위와 실제 예시 제공

#### 2. **백엔드 좌표 검증 시스템**
```python
# 주요 도시 30개의 실제 좌표 DB
CITY_COORDS = {
    "강릉": (37.7519, 128.8761),
    "부산": (35.1796, 129.0756),
    # ... 30개 도시
}

# 좌표 검증 로직
1. 도시명이 DB에 있으면 실제 좌표 적용
2. 스팟 좌표가 지역 범위 밖이면 자동 보정
3. 예시 좌표(37.5, 127.0) 감지 시 자동 보정
```

#### 3. **검증 결과**
```
✅ 좌표 검증 시작...
   ✓ 강릉: 실제 좌표 적용 (37.7519, 128.8761)
   ✓ 안목해변 커피거리: 정확한 좌표 (37.7714, 128.9469)
   ⚠ 엉뚱한 카페: 좌표 보정 (37.7465, 128.8912)
✅ 좌표 검증 완료
```

## 🛠️ 기술 스택

### Frontend
- HTML5, CSS3, JavaScript
- Kakao Maps API

### Backend
- Python 3.10+
- Flask
- **Google Gemini 2.5 Flash Lite** (좌표 검증 버전)

## 🚀 빠른 시작

### 1. 필요한 패키지 설치
```bash
pip install flask flask-cors python-dotenv requests
```

### 2. API 키 설정
`.env` 파일 생성:
```env
GOOGLE_API_KEY=your-google-api-key-here
```

🔑 API 키 발급: https://makersuite.google.com/app/apikey

### 3. 서버 실행
```bash
python api.py
```

### 4. 브라우저 접속
```
http://localhost:5000
```

## 📂 파일 구조

```
/
├── api.py              # Flask 서버 (CORS 설정)
├── gemini_engine.py    # Gemini + 좌표 검증 엔진
├── index.html          # 프론트엔드 HTML
├── app.js              # 프론트엔드 로직
├── style.css           # 스타일시트
├── .env                # API 키 (직접 생성 필요)
└── README.md           # 이 파일
```

## 🔧 주요 기능

### 1. AI 기반 여행지 추천
- Gemini API로 실시간 여행지 생성
- 사용자 선호도 기반 매칭 알고리즘

### 2. 카카오맵 연동
- **정확한 좌표로 마커 표시**
- 여행 동선 시각화 (폴리라인)
- 마커 클릭/호버 정보창

### 3. 좌표 검증 시스템
- 30개 주요 도시 실제 좌표 DB
- 지역별 좌표 범위 체크
- 잘못된 좌표 자동 보정

## 🎯 사용 방법

1. **지역 선택** (전국/강원/경기/충청/전라/경상/부산/제주)
2. **여행 스타일** (계획형/즉흥형/중간형)
3. **동행** (솔로/친구/커플/가족/단체)
4. **테마** (맛집/카페/로컬/감성 등 최대 3개)
5. **세부 옵션** (페이스/교통/분위기)
6. **AI 추천 결과 확인**
7. **지도에서 정확한 위치 확인** ✨

## 🐛 트러블슈팅

### 좌표가 여전히 이상한 곳에 찍혀요
1. 터미널 로그 확인:
```
🔍 좌표 검증 시작...
   ✓ 도시명: 실제 좌표 적용
   ⚠ 장소명: 좌표 보정
```

2. 보정된 좌표가 보이면 정상 작동 중입니다.

3. 만약 여전히 문제가 있다면:
   - Gemini API가 실제 좌표를 반환했는지 확인
   - `CITY_COORDS`에 해당 도시 추가
   - `REGION_COORDS`에서 좌표 범위 확인

### API 키 오류
```
❌ 오류: GOOGLE_API_KEY 환경변수가 설정되지 않았습니다.
```
→ `.env` 파일에 올바른 API 키 입력

### 포트 충돌
```
OSError: [Errno 48] Address already in use
```
→ `api.py`에서 포트 변경 (기본 5000)

## 📝 라이선스

MIT License

---

⭐ 좌표 문제가 완전히 해결된 버전입니다!
